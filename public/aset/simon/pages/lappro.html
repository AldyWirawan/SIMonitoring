<div class="row">
	<div class="col-md-12">
		<h1 class="text-center" style="margin-bottom: 40px">Laporan Proyek</h1>

		<a id="delete" class="btn btn-danger pull-left">Delete</a>
		<a href="#/tambah_proyek" class="btn btn-primary pull-right">Tambah Proyek</a>
		<br><br>
		<div class="table-responsive">
			<table id="proyek" class="table table-condensed table-bordered table-striped">
				<thead>
					<tr>
						<th>ID</th>
						<th>UUK</th>
						<th>PIN</th>
						<th>Tanggal Catat</th>
						<th>Nama Pekerjaan</th>
						<th>Nama Pemberi Kerja</th>
						<th>Nama Ketua Pelaksana</th>
						<th>Tanggal Kontrak</th>
						<th>Nomor Kontrak</th>
						<th>Akhir Periode Kontrak</th>
						<th>Nilai Total Kontrak</th>
						<th>Invoice</th>
						<th>Sisa Invoice</th>
						<th>Usulan Penghapusan Proyek</th>
						<th>Total Realisasi</th>
						<th>Pre-Financing</th>
						<th>Status Pekerjaan</th>
						<th>Persentase Proyek</th>
					</tr>
				</thead>
			</table>
		</div>

		<div class="row" style="margin-top: 30px">
			<div class="col-md-3 well">
				<form action="proyek/import_excel" method="post" enctype="multipart/form-data">
					<label class="control-label">Upload Ms. Excel</label>
					<input type="file" class="form-control" name="excel">
					<br>
					<input type="submit" value="Import" class="btn btn-primary">
					<a href="proyek/download_template" class="btn btn-danger">Download Template</a>
				</form>
			</div>
		</div>
	</div>
</div>

<script type="text/javascript">
	$(document).ready(function() {

		var table = $('#proyek').DataTable( {
			serverSide: true,
			processing: true,
			ajax: 'proyek/dataTableAll',
			columns: [
				{data: 'id', name: 'id'},
	            {data: 'nama_uuk', name: 'nama_uuk'},
	            {data: 'pin', name: 'pin'},
	            {data: 'tanggal_catat', name: 'tanggal_catat'},
	            {data: 'nama_pekerjaan', name: 'nama_pekerjaan'},
	            {data: 'nama_pemberi_kerja', name: 'nama_pemberi_kerja'},
	            {data: 'nama_ketua_pelaksana', name: 'nama_ketua_pelaksana'},
	            {data: 'kontrak_tanggal', name: 'kontrak_tanggal'},
	            {data: 'kontrak_nomor', name: 'kontrak_nomor'},
	            {data: 'kontrak_akhir_periode', name: 'kontrak_akhir_periode'},
	            {data: 'kontrak_nilai_total', name: 'kontrak_nilai_total'},
	            {data: 'keuangan_invoice_total', name: 'keuangan_invoice_total'},
	            {data: 'keuangan_sisa_invoice_total', name: 'keuangan_sisa_invoice_total'},
	            {data: 'keuangan_usulan_penghapusan_proyek', name: 'keuangan_usulan_penghapusan_proyek'},
	            {data: 'keuangan_total_realisasi', name: 'keuangan_total_realisasi'},
	            {data: 'keuangan_pre_financing', name: 'keuangan_pre_financing'},
	            {data: 'status_pekerjaan', name: 'status_pekerjaan'},
	            {data: 'persentase_progres_proyek', name: 'persentase_progres_proyek'},
	            //{data: 'action', name: 'action', orderable: false, searchable: false}
        	],
        	columnDefs: [
        		{
        			targets:[ 0 ],
        			visible: false,
        			searchable: false,
        		}
        	]
		});

		$('#proyek tbody').on( 'click', 'tr', function () {
        if ( $(this).hasClass('selected') ) {
            $(this).removeClass('selected');
        }
        else {
            table.$('tr.selected').removeClass('selected');
            $(this).addClass('selected');
        }
    	} );

		$('#delete').click( function () {
			// table.row('.selected').data().id
			//table.row('.selected').remove().draw( false );
			$.ajax({
           		type: "DELETE",
           		url: "proyek/"+table.row('.selected').data().id,
           		success: function(){
                	table.row('.selected').remove().draw( false );
           		}
        	});
		})
		
	})
</script>